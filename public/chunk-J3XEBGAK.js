import{a as $}from"./chunk-BWFQEKZQ.js";import{a as R}from"./chunk-PAP2UETD.js";import{a as S,b as d,c as I,d as w,g as T,h as j,i as F,j as N,k as A,l as q,m as k,n as D,p as z,q as V,r as B}from"./chunk-DX54PZ3W.js";import{a as G}from"./chunk-DVA2SMLH.js";import"./chunk-LJ5XHLMQ.js";import{e as M,g as O,m as y}from"./chunk-VX3KMHVW.js";import{$a as l,Da as E,Ha as c,Na as u,Ua as r,Va as n,Wa as f,Xa as h,Ya as P,Z as C,Za as s,_ as b,bb as g,ua as a,za as _}from"./chunk-353TJUNG.js";import{f as L,h as x}from"./chunk-FK42CRUA.js";var v=L($());function J(t,i){if(t&1&&(r(0,"p"),l(1),n()),t&2){let e=s();a(),g("Hola, ",e.userName,"! Por favor, completa la encuesta.")}}function U(t,i){if(t&1&&(r(0,"p"),l(1),n()),t&2){let e=s();a(),g("Hola, ",e.userEmail,"! Por favor, completa la encuesta.")}}function Z(t,i){t&1&&(r(0,"p"),l(1,"Por favor, completa la encuesta."),n())}function Y(t,i){t&1&&(r(0,"div"),l(1,"El nombre es requerido."),n())}function K(t,i){t&1&&(r(0,"div"),l(1,"El nombre solo debe contener letras."),n())}function Q(t,i){if(t&1&&(r(0,"div",24),c(1,Y,2,0,"div",1)(2,K,2,0,"div",1),n()),t&2){let e=s(2);a(),u("ngIf",e.nombre==null||e.nombre.errors==null?null:e.nombre.errors.required),a(),u("ngIf",e.nombre==null||e.nombre.errors==null?null:e.nombre.errors.pattern)}}function W(t,i){t&1&&(r(0,"div"),l(1,"El apellido es requerido."),n())}function X(t,i){t&1&&(r(0,"div"),l(1,"El apellido solo debe contener letras."),n())}function ee(t,i){if(t&1&&(r(0,"div",24),c(1,W,2,0,"div",1)(2,X,2,0,"div",1),n()),t&2){let e=s(2);a(),u("ngIf",e.apellido==null||e.apellido.errors==null?null:e.apellido.errors.required),a(),u("ngIf",e.apellido==null||e.apellido.errors==null?null:e.apellido.errors.pattern)}}function te(t,i){t&1&&(r(0,"div"),l(1,"La edad es requerida."),n())}function ne(t,i){t&1&&(r(0,"div"),l(1,"Debes tener al menos 18 a\xF1os."),n())}function oe(t,i){t&1&&(r(0,"div"),l(1,"La edad m\xE1xima es 99 a\xF1os."),n())}function re(t,i){if(t&1&&(r(0,"div",24),c(1,te,2,0,"div",1)(2,ne,2,0,"div",1)(3,oe,2,0,"div",1),n()),t&2){let e=s(2);a(),u("ngIf",e.edad==null||e.edad.errors==null?null:e.edad.errors.required),a(),u("ngIf",e.edad==null||e.edad.errors==null?null:e.edad.errors.min),a(),u("ngIf",e.edad==null||e.edad.errors==null?null:e.edad.errors.max)}}function ie(t,i){t&1&&(r(0,"div"),l(1,"El tel\xE9fono es requerido."),n())}function le(t,i){t&1&&(r(0,"div"),l(1,"El tel\xE9fono solo debe contener n\xFAmeros."),n())}function ae(t,i){t&1&&(r(0,"div"),l(1,"El tel\xE9fono debe tener al menos 6 d\xEDgitos."),n())}function ue(t,i){t&1&&(r(0,"div"),l(1,"El tel\xE9fono no debe exceder los 10 d\xEDgitos."),n())}function me(t,i){if(t&1&&(r(0,"div",24),c(1,ie,2,0,"div",1)(2,le,2,0,"div",1)(3,ae,2,0,"div",1)(4,ue,2,0,"div",1),n()),t&2){let e=s(2);a(),u("ngIf",e.telefono==null||e.telefono.errors==null?null:e.telefono.errors.required),a(),u("ngIf",e.telefono==null||e.telefono.errors==null?null:e.telefono.errors.pattern),a(),u("ngIf",e.telefono==null||e.telefono.errors==null?null:e.telefono.errors.minlength),a(),u("ngIf",e.telefono==null||e.telefono.errors==null?null:e.telefono.errors.maxlength)}}function de(t,i){t&1&&(r(0,"div"),l(1,"Debes seleccionar un juego."),n())}function ce(t,i){if(t&1&&(r(0,"div",24),c(1,de,2,0,"div",1),n()),t&2){let e,m=s(2);a(),u("ngIf",(e=m.form.get("juegoFavorito"))==null||e.errors==null?null:e.errors.required)}}function pe(t,i){t&1&&(r(0,"div"),l(1,"El puntaje es requerido."),n())}function se(t,i){t&1&&(r(0,"div"),l(1,"El puntaje m\xEDnimo es 1."),n())}function fe(t,i){t&1&&(r(0,"div"),l(1,"El puntaje m\xE1ximo es 10."),n())}function _e(t,i){if(t&1&&(r(0,"div",24),c(1,pe,2,0,"div",1)(2,se,2,0,"div",1)(3,fe,2,0,"div",1),n()),t&2){let e,m,p,o=s(2);a(),u("ngIf",(e=o.form.get("puntaje"))==null||e.errors==null?null:e.errors.required),a(),u("ngIf",(m=o.form.get("puntaje"))==null||m.errors==null?null:m.errors.min),a(),u("ngIf",(p=o.form.get("puntaje"))==null||p.errors==null?null:p.errors.max)}}function ge(t,i){if(t&1){let e=h();r(0,"form",3),P("ngSubmit",function(){C(e);let p=s();return b(p.enviarForm())}),r(1,"div",4)(2,"label",5),l(3,"Nombre"),n(),f(4,"input",6),c(5,Q,3,2,"div",7),n(),r(6,"div",4)(7,"label",8),l(8,"Apellido"),n(),f(9,"input",9),c(10,ee,3,2,"div",7),n(),r(11,"div",4)(12,"label",10),l(13,"Edad"),n(),f(14,"input",11),c(15,re,4,3,"div",7),n(),r(16,"div",4)(17,"label",12),l(18,"Tel\xE9fono"),n(),f(19,"input",13),c(20,me,5,4,"div",7),n(),r(21,"div",4)(22,"label",14),l(23,"Juego Favorito"),n(),r(24,"select",15)(25,"option",16),l(26,"Preguntados"),n(),r(27,"option",17),l(28,"Mayor o Menor"),n(),r(29,"option",18),l(30,"Solitario"),n(),r(31,"option",19),l(32,"Ahorcado"),n()(),c(33,ce,2,1,"div",7),n(),r(34,"div",4)(35,"label",20),l(36,"Puntaje del 1 al 10"),n(),f(37,"input",21),r(38,"p",22),l(39),n(),c(40,_e,4,3,"div",7),n(),r(41,"button",23),l(42,"Enviar Encuesta"),n()()}if(t&2){let e,m,p,o=s();u("formGroup",o.form),a(5),u("ngIf",(o.nombre==null?null:o.nombre.invalid)&&((o.nombre==null?null:o.nombre.dirty)||(o.nombre==null?null:o.nombre.touched)||o.submitted)),a(5),u("ngIf",(o.apellido==null?null:o.apellido.invalid)&&((o.apellido==null?null:o.apellido.dirty)||(o.apellido==null?null:o.apellido.touched)||o.submitted)),a(5),u("ngIf",(o.edad==null?null:o.edad.invalid)&&((o.edad==null?null:o.edad.dirty)||(o.edad==null?null:o.edad.touched)||o.submitted)),a(5),u("ngIf",(o.telefono==null?null:o.telefono.invalid)&&((o.telefono==null?null:o.telefono.dirty)||(o.telefono==null?null:o.telefono.touched)||o.submitted)),a(13),u("ngIf",((e=o.form.get("juegoFavorito"))==null?null:e.invalid)&&(((e=o.form.get("juegoFavorito"))==null?null:e.dirty)||((e=o.form.get("juegoFavorito"))==null?null:e.touched)||o.submitted)),a(6),g("Valor: ",(m=o.form.get("puntaje"))==null?null:m.value,""),a(),u("ngIf",((p=o.form.get("puntaje"))==null?null:p.invalid)&&(((p=o.form.get("puntaje"))==null?null:p.dirty)||((p=o.form.get("puntaje"))==null?null:p.touched)||o.submitted)),a(),u("disabled",o.form.invalid)}}var H=class t{constructor(i,e,m){this.fb=i;this.authService=e;this.router=m}form;submitted=!1;userEmail=null;userName=null;userId=0;ngOnInit(){return x(this,null,function*(){let{data:{user:i}}=yield this.authService.getCurrentUser();if(this.userEmail=i?.email||null,this.userEmail){let e=yield this.authService.getUserProfile();this.userName=e.name,this.userId=e.authId}this.initializeForm()})}initializeForm(){this.form=this.fb.group({nombre:["",[d.pattern("^[a-zA-Z]+$"),d.required]],apellido:["",[d.pattern("^[a-zA-Z]+$"),d.required]],edad:["",[d.required,d.min(18),d.max(99)]],telefono:["",[d.pattern("^[0-9]*$"),d.minLength(6),d.maxLength(10),d.required]],juegoFavorito:["preguntados",d.required],puntaje:[5,[d.required,d.min(1),d.max(10)]]})}get nombre(){return this.form.get("nombre")}get apellido(){return this.form.get("apellido")}get edad(){return this.form.get("edad")}get telefono(){return this.form.get("telefono")}enviarForm(){return x(this,null,function*(){if(this.submitted=!0,!this.form.invalid)try{let i={fecha:new Date().toISOString(),email:this.userEmail,nombre:this.form.value.nombre,apellido:this.form.value.apellido,edad:this.form.value.edad,telefono:this.form.value.telefono,juego_favorito:this.form.value.juegoFavorito,puntaje:this.form.value.puntaje,user_id:this.userId},{data:e,error:m}=yield G.from("encuestas").insert(i).select();if(m)throw m;this.showSuccessAlert()}catch(i){console.error("Error al guardar encuesta:",i),this.showErrorAlert()}})}showSuccessAlert(){v.default.fire({icon:"success",title:"Encuesta enviada con \xE9xito",showCancelButton:!0,confirmButtonText:"Otra encuesta",cancelButtonText:"Volver al Menu",reverseButtons:!0,backdrop:!0,allowOutsideClick:!1}).then(i=>{i.isConfirmed?this.reiniciarPagina():i.dismiss===v.default.DismissReason.cancel&&this.volverAlHome()})}showErrorAlert(){v.default.fire({icon:"error",title:"Error",text:"No se pudo enviar la encuesta. Por favor intenta nuevamente."})}reiniciarPagina(){window.location.reload()}volverAlHome(){this.router.navigate(["/home"])}static \u0275fac=function(e){return new(e||t)(_(z),_(R),_(y))};static \u0275cmp=E({type:t,selectors:[["app-encuesta"]],decls:7,vars:4,consts:[[1,"encuesta-container"],[4,"ngIf"],["class","encuesta-form",3,"formGroup","ngSubmit",4,"ngIf"],[1,"encuesta-form",3,"ngSubmit","formGroup"],[1,"form-group"],["for","nombre"],["type","text","id","nombre","formControlName","nombre","placeholder","Tu nombre"],["class","error-message",4,"ngIf"],["for","apellido"],["type","text","id","apellido","formControlName","apellido","placeholder","Tu apellido"],["for","edad"],["type","number","id","edad","formControlName","edad","placeholder","Tu edad"],["for","telefono"],["type","tel","id","telefono","formControlName","telefono","placeholder","Ej: 1123456789"],["for","juegoFavorito"],["id","juegoFavorito","formControlName","juegoFavorito"],["value","preguntados"],["value","mayorOmenor"],["value","solitario"],["value","ahorcado"],["for","puntaje"],["type","range","id","puntaje","formControlName","puntaje","min","1","max","10"],[1,"range-value"],["type","submit",3,"disabled"],[1,"error-message"]],template:function(e,m){e&1&&(r(0,"div",0)(1,"h2"),l(2,"Encuesta de Juegos"),n(),c(3,J,2,1,"p",1)(4,U,2,1,"p",1)(5,Z,2,0,"p",1)(6,ge,43,9,"form",2),n()),e&2&&(a(3),u("ngIf",m.userName),a(),u("ngIf",!m.userName&&m.userEmail),a(),u("ngIf",!m.userName&&!m.userEmail),a(),u("ngIf",m.form))},dependencies:[B,T,k,D,S,j,F,q,I,w,N,A,V,O,M],styles:[".encuesta-container[_ngcontent-%COMP%]{max-width:600px;margin:40px auto;padding:30px;background-color:#f9f9f9;border-radius:10px;box-shadow:0 4px 15px #0000001a;font-family:Arial,sans-serif;color:#333;text-align:center}.encuesta-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#007bff;margin-bottom:20px;font-size:2em}.encuesta-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#555;margin-bottom:25px;font-size:1.1em}.encuesta-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px}.encuesta-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{text-align:left;display:flex;flex-direction:column}.encuesta-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:700;margin-bottom:8px;color:#333;font-size:.95em}.encuesta-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%], .encuesta-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%], .encuesta-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[type=tel][_ngcontent-%COMP%], .encuesta-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:12px 15px;border:1px solid #ccc;border-radius:5px;font-size:1em;width:100%;box-sizing:border-box;transition:border-color .3s ease}.encuesta-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]:focus, .encuesta-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%]:focus, .encuesta-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[type=tel][_ngcontent-%COMP%]:focus, .encuesta-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{border-color:#007bff;outline:none;box-shadow:0 0 5px #007bff33}.encuesta-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[type=range][_ngcontent-%COMP%]{width:100%;margin-top:10px;-webkit-appearance:none;appearance:none;height:8px;background:#ddd;border-radius:5px;outline:none;opacity:.7;transition:opacity .2s}.encuesta-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[type=range][_ngcontent-%COMP%]:hover{opacity:1}.encuesta-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:20px;height:20px;background:#007bff;border-radius:50%;cursor:pointer;box-shadow:0 0 5px #007bff66}.encuesta-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[type=range][_ngcontent-%COMP%]::-moz-range-thumb{width:20px;height:20px;background:#007bff;border-radius:50%;cursor:pointer;box-shadow:0 0 5px #007bff66}.encuesta-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .range-value[_ngcontent-%COMP%]{text-align:center;margin-top:10px;font-weight:700;color:#007bff}.encuesta-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]{color:#dc3545;font-size:.85em;margin-top:5px;padding-left:5px}.encuesta-form[_ngcontent-%COMP%]   button[type=submit][_ngcontent-%COMP%]{background-color:#007bff;color:#fff;padding:12px 25px;border:none;border-radius:5px;font-size:1.1em;cursor:pointer;transition:background-color .3s ease,transform .2s ease;margin-top:20px}.encuesta-form[_ngcontent-%COMP%]   button[type=submit][_ngcontent-%COMP%]:hover{background-color:#0056b3;transform:translateY(-2px)}.encuesta-form[_ngcontent-%COMP%]   button[type=submit][_ngcontent-%COMP%]:disabled{background-color:#ccc;cursor:not-allowed;transform:none}"]})};export{H as EncuestaComponent};
